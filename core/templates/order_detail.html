{% extends "base.html" %}
{% block title %}Order #{{ order.id }}{% endblock %}
{% block content %}
<h3>Order #{{ order.id }}</h3>
<p>Status: <strong>{{ order.get_status_display }}</strong></p>
<div class="row">
  <div class="col-md-8">
    <table class="table">
      <thead><tr><th>Product</th><th>Qty</th><th>Price</th><th>Subtotal</th></tr></thead>
      <tbody>
        {% for it in order.items.all %}
          <tr><td>{{ it.product.name }}</td><td>{{ it.quantity }}</td><td>₹{{ it.price }}</td><td>₹{{ it.subtotal }}</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="col-md-4">
    <div class="card card-body">
      <div class="d-flex justify-content-between"><span>Total</span><strong>₹ {{ order.total }}</strong></div>
      <hr>
      <h6>Tracking</h6>
      {% if order.tracking_code %}
        <p>Tracking Code: <strong>{{ order.tracking_code }}</strong></p>
      {% else %}
        <p>Tracking will appear when shipped.</p>
      {% endif %}
      <hr>
      <h6>History</h6>
      <ul class="list-unstyled">
        {% for h in order.history.all %}
          <li>{{ h.created_at|date:"d M Y H:i" }} — {{ h.old_status }} → {{ h.new_status }} {% if h.note %} ({{ h.note }}){% endif %}</li>
        {% empty %}
          <li>No updates yet.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}

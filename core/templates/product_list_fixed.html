{% extends "base.html" %}
{% load static %}
{% block title %}{% if active_category %}{{ active_category.name }} — {% endif %}Products{% endblock %}
{% block content %}
<div class="row">
  <aside class="col-lg-3 mb-3">
    <div class="card card-pjp p-3 pjp-sidebar">
      <h5>Categories</h5>
      <ul class="list-unstyled mb-0">
        <li class="mb-2"><a href="{% url 'core:product_list' %}" class="{% if not active_category %}fw-bold{% endif %}">All Products</a></li>
        {% for c in GLOBAL_CATEGORIES %}
          <li class="mb-2">
            <a href="{% url 'core:product_list_by_category' c.slug %}" 
               class="{% if active_category and c.slug == active_category.slug %}fw-bold{% endif %}">
              {{ c.name }} <small class="text-muted">({{ c.product_set.count }})</small>
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </aside>

  <section class="col-lg-9">
    {% if active_category %}
      <h3 class="mb-3">{{ active_category.name }}</h3>
    {% else %}
      <h3 class="mb-3">All Products</h3>
    {% endif %}

    <form method="get" class="mb-3 d-flex gap-2">
      <input name="q" value="{{ query }}" class="form-control" placeholder="Search products...">
      <select name="sort" class="form-select" style="width:140px;">
        <option value="new" {% if sort == 'new' %}selected{% endif %}>Newest</option>
        <option value="az" {% if sort == 'az' %}selected{% endif %}>A → Z</option>
        <option value="za" {% if sort == 'za' %}selected{% endif %}>Z → A</option>
        <option value="price_low" {% if sort == 'price_low' %}selected{% endif %}>Price: Low to High</option>
        <option value="price_high" {% if sort == 'price_high' %}selected{% endif %}>Price: High to Low</option>
      </select>
      <button class="btn btn-pjp">Search</button>
    </form>

    <div class="row">
      <!-- Show all products when no category is selected -->
      {% if not active_category %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Bangles & Half set/banglesimg (1).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Fancy Bangle 1</h6>
              <p class="mb-2">₹110</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="1">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Bangles & Half set/banglesimg (8).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Fancy Bangle 2</h6>
              <p class="mb-2">₹130</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="2">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Carry bags/carrybagimg (5).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Carry Bag 1</h6>
              <p class="mb-2">₹15</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="3">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Display toys/toysimg (3).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Display Toys 1</h6>
              <p class="mb-2">₹900</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="4">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Wall clock/clockimg (15).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Wall Clock 1</h6>
              <p class="mb-2">₹175</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="5">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Fancy Purse set 1×3/fancypurseimg (1).jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Fancy Purse Set 1</h6>
              <p class="mb-2">₹68</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="6">Add to cart</button>
              </div>
            </div>
          </div>
        </div>

      {% elif active_category.slug == 'bangles-half-set' %}
        <!-- Bangles & Half set - All 12 products -->
        {% for i in "123456789012" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Bangles & Half set/banglesimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Bangles {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 110 130 120 140 115 125 135 145 155 165 175 185 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:10 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'carry-bags' %}
        <!-- Carry bags - All 11 products -->
        {% for i in "12345678901" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Carry bags/carrybagimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Carry bags {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 15 20 18 25 22 30 28 35 32 40 38 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:100 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'display-toys' %}
        <!-- Display toys - All 15 products -->
        {% for i in "123456789012345" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Display toys/toysimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Display toys {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 900 1200 800 1500 1000 1100 950 1300 850 1400 750 1600 650 1700 550 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:200 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'fancy-carry-bag' %}
        <!-- Fancy carry bag products -->
        {% for i in "12345678" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Fancy carry bag/fancycarrybagimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Fancy carry bag {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 45 55 50 60 48 58 52 62 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:300 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'fancy-purse-set-1x3' %}
        <!-- Fancy Purse set products -->
        {% for i in "1234567890" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Fancy Purse set 1×3/fancypurseimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Fancy Purse set 1×3 {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 68 75 70 80 72 78 74 82 76 85 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:400 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'purse' %}
        <!-- Purse products -->
        {% for i in "123456789012" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Purse/purseimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Purse {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 35 42 38 45 40 48 43 50 36 46 39 52 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:500 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% elif active_category.slug == 'wall-clock' %}
        <!-- Wall clock products -->
        {% for i in "123456789012345" %}
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card card-pjp h-100">
            <img src="{% static 'images/Wall clock/clockimg (' %}{{ forloop.counter }}{% static ').jpg' %}" class="card-img-top" style="height:200px;object-fit:cover;">
            <div class="card-body d-flex flex-column">
              <h6 style="color:var(--pjp-text-dark)">Wall clock {{ forloop.counter }}</h6>
              <p class="mb-2">₹{% cycle 175 185 180 195 190 200 188 205 178 210 182 215 170 220 165 %}</p>
              <div class="d-flex gap-2 mt-auto">
                <button class="btn btn-pjp add-to-cart" data-id="{{ forloop.counter|add:600 }}">Add to cart</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      {% else %}
        <div class="text-center py-5">
          <p class="text-muted">No products found for this category.</p>
          <a href="{% url 'core:product_list' %}" class="btn btn-outline-secondary">View All Products</a>
        </div>
      {% endif %}
    </div>
  </section>
</div>
{% endblock %}
